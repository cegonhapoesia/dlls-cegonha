<html>
<head>
<meta charset="utf-8">
<title>HTA Pentest Toolkit Avançado</title>
<HTA:APPLICATION
  ID="oHTA"
  APPLICATIONNAME="HTAPentestAvancado"
  BORDER="thin"
  CAPTION="yes"
  SHOWINTASKBAR="yes"
  SINGLEINSTANCE="yes"
  SYSMENU="yes"
/>
<style>
  body { font-family: Arial, sans-serif; margin: 10px; background-color: #f9f9f9; }
  textarea, input[type=text], select { width: 100%; padding: 6px; margin-top: 5px; font-family: monospace; }
  button { padding: 6px 12px; margin-top: 5px; cursor: pointer; background-color: #0078D7; color: white; border: none; border-radius: 4px; }
  .section { border: 1px solid #ccc; background: #fff; padding: 10px; margin-top: 15px; border-radius: 5px; box-shadow: 1px 1px 3px #ddd; }
  h1 { color: #333; }
  label { font-weight: bold; margin-top: 10px; display: block; }
</style>
<script language="VBScript">
Sub btnScrape_OnClick()
    Dim url, http, html
    url = document.getElementById("txtUrl").value
    If url = "" Then MsgBox "Insira uma URL.": Exit Sub
    Set http = CreateObject("MSXML2.XMLHTTP")
    On Error Resume Next
    http.Open "GET", url, False
    http.Send
    If Err.Number <> 0 Then MsgBox "Erro: " & Err.Description: Exit Sub
    On Error GoTo 0
    html = http.responseText
    document.getElementById("txtResult").value = html
    document.getElementById("txtHeaders").value = http.getAllResponseHeaders
End Sub

Sub btnPing_OnClick()
    Dim ip, shell, exec, output, line
    ip = document.getElementById("txtPingIp").value
    If ip = "" Then MsgBox "Insira um IP ou hostname.": Exit Sub
    Set shell = CreateObject("WScript.Shell")
    Set exec = shell.Exec("ping -n 4 " & ip)
    output = ""
    Do While Not exec.StdOut.AtEndOfStream
        line = exec.StdOut.ReadLine()
        output = output & line & vbCrLf
    Loop
    document.getElementById("txtPingResult").value = output
End Sub

Sub btnTcpTest_OnClick()
    Dim host, port, socket, result
    host = document.getElementById("txtTcpHost").value
    port = document.getElementById("txtTcpPort").value
    If host = "" Or Not IsNumeric(port) Then MsgBox "Host ou porta inválida.": Exit Sub
    On Error Resume Next
    Set socket = CreateObject("MSWinsock.Winsock")
    socket.RemoteHost = host
    socket.RemotePort = CInt(port)
    socket.Connect
    WScript.Sleep 2000
    If socket.Connected Then
        result = "Conexão OK: " & host & ":" & port
        socket.Close
    Else
        result = "Falha ao conectar: " & host & ":" & port
    End If
    On Error GoTo 0
    document.getElementById("txtTcpResult").value = result
End Sub

Sub btnHttpRequest_OnClick()
    Dim url, method, data, http, response
    url = document.getElementById("txtHttpUrl").value
    method = document.getElementById("selHttpMethod").value
    data = document.getElementById("txtHttpData").value
    If url = "" Then MsgBox "Insira uma URL.": Exit Sub
    Set http = CreateObject("MSXML2.XMLHTTP")
    On Error Resume Next
    http.Open method, url, False
    If method = "POST" Then
        http.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
        http.Send data
    Else
        http.Send
    End If
    If Err.Number <> 0 Then MsgBox "Erro HTTP: " & Err.Description: Exit Sub
    On Error GoTo 0
    response = "Status: " & http.Status & " " & http.statusText & vbCrLf & _
               "Headers:" & vbCrLf & http.getAllResponseHeaders & vbCrLf & _
               "Body:" & vbCrLf & http.responseText
    document.getElementById("txtHttpResult").value = response
End Sub

Sub btnSaveResult_OnClick()
    Dim fso, path, content
    path = document.getElementById("txtSavePath").value
    content = document.getElementById("txtResult").value
    If path = "" Then MsgBox "Caminho vazio.": Exit Sub
    Set fso = CreateObject("Scripting.FileSystemObject")
    Set file = fso.CreateTextFile(path, True)
    file.Write content
    file.Close
    MsgBox "Arquivo salvo: " & path
End Sub

Sub btnRunCmd_OnClick()
    Dim cmd, shell, exec, output, line
    cmd = document.getElementById("txtCmd").value
    If cmd = "" Then MsgBox "Insira um comando.": Exit Sub
    If MsgBox("Executar: " & cmd & " ?", vbYesNo) = vbNo Then Exit Sub
    Set shell = CreateObject("WScript.Shell")
    Set exec = shell.Exec("cmd /c " & cmd)
    output = ""
    Do While Not exec.StdOut.AtEndOfStream
        line = exec.StdOut.ReadLine()
        output = output & line & vbCrLf
    Loop
    document.getElementById("txtCmdResult").value = output
End Sub

Sub btnSearchPentest_OnClick()
    Dim query, bingUrl, googleUrl
    query = document.getElementById("txtSearchPentest").value
    If query = "" Then MsgBox "Insira uma pesquisa.": Exit Sub
    bingUrl = "https://www.bing.com/search?q=" & Replace(query, " ", "+")
    googleUrl = "https://www.google.com/search?q=" & Replace(query, " ", "+")
    Set shell = CreateObject("WScript.Shell")
    shell.Run bingUrl
    shell.Run googleUrl
End Sub
</script>
</head>
<body>
<h1>HTA Pentest Toolkit Avançado</h1>

<div class="section">
  <h3>1. Pesquisa Universal Pentest</h3>
  <input type="text" id="txtSearchPentest" placeholder="Buscar por exploits, CVEs, payloads...">
  <button onclick="btnSearchPentest_OnClick">Pesquisar no Bing & Google</button>
</div>

<div class="section">
  <h3>2. Raspagem de HTML</h3>
  <input type="text" id="txtUrl" placeholder="https://exemplo.com" />
  <button onclick="btnScrape_OnClick">Raspar HTML</button>
  <label>Resultado HTML:</label>
  <textarea id="txtResult" readonly></textarea>
  <label>Headers:</label>
  <textarea id="txtHeaders" readonly></textarea>
  <label>Salvar resultado:</label>
  <input type="text" id="txtSavePath" placeholder="C:\\caminho\\arquivo.html" />
  <button onclick="btnSaveResult_OnClick">Salvar</button>
</div>

<div class="section">
  <h3>3. Ping</h3>
  <input type="text" id="txtPingIp" placeholder="IP ou hostname" />
  <button onclick="btnPing_OnClick">Ping</button>
  <textarea id="txtPingResult" readonly></textarea>
</div>

<div class="section">
  <h3>4. Teste de Conexão TCP</h3>
  <input type="text" id="txtTcpHost" placeholder="Host" />
  <input type="text" id="txtTcpPort" placeholder="Porta" style="width: 60px;" />
  <button onclick="btnTcpTest_OnClick">Testar</button>
  <textarea id="txtTcpResult" readonly></textarea>
</div>

<div class="section">
  <h3>5. Requisição HTTP</h3>
  <input type="text" id="txtHttpUrl" placeholder="URL" />
  <select id="selHttpMethod">
    <option>GET</option>
    <option>POST</option>
  </select>
  <label>POST Data:</label>
  <textarea id="txtHttpData" style="height: 60px;"></textarea>
  <button onclick="btnHttpRequest_OnClick">Enviar</button>
  <textarea id="txtHttpResult" readonly style="height: 150px;"></textarea>
</div>

<div class="section">
  <h3>6. Comando do Sistema</h3>
  <input type="text" id="txtCmd" placeholder="Comando (ex: ipconfig)" />
  <button onclick="btnRunCmd_OnClick">Executar</button>
  <textarea id="txtCmdResult" readonly style="height: 150px;"></textarea>
</div>

</body>
</html>
